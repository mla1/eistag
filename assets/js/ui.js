!function($){var oldScrollPos,scrollPos,$htmlbody,$window=$(window),$body=$("body"),$header=($("#wrapper"),$("#header")),$footer=$("#footer"),$main=$("#main"),$main_articles=$main.children("article"),$nav=($window.on("load",function(){window.setTimeout(function(){$body.removeClass("is-preload")},100)}),$header.children("nav")),$nav_li=$nav.find("li"),locked=($nav_li.length%2==0&&($nav.addClass("use-middle"),$nav_li.eq($nav_li.length/2).addClass("is-middle")),!1);$main._show=function(id,initial){var $currentArticle,$article=$main_articles.filter("#"+id);0!=$article.length&&(locked||void 0!==initial&&!0===initial?($body.addClass("is-switching"),$body.addClass("is-article-visible"),$main_articles.removeClass("active"),$header.hide(),$footer.hide(),$main.show(),$article.show(),$article.addClass("active"),locked=!1,setTimeout(function(){$body.removeClass("is-switching")},initial?1e3:0)):(locked=!0,$body.hasClass("is-article-visible")?(($currentArticle=$main_articles.filter(".active")).removeClass("active"),setTimeout(function(){$currentArticle.hide(),$article.show(),setTimeout(function(){$article.addClass("active"),$window.scrollTop(0).triggerHandler("resize.flexbox-fix"),setTimeout(function(){locked=!1},325)},25)},325)):($body.addClass("is-article-visible"),setTimeout(function(){$header.hide(),$footer.hide(),$main.show(),$article.show(),setTimeout(function(){$article.addClass("active"),$window.scrollTop(0).triggerHandler("resize.flexbox-fix"),setTimeout(function(){locked=!1},325)},25)},325))))},$main._hide=function(addState){var $article=$main_articles.filter(".active");$body.hasClass("is-article-visible")&&(void 0!==addState&&!0===addState&&history.pushState(null,null,"#"),locked?($body.addClass("is-switching"),$article.removeClass("active"),$article.hide(),$main.hide(),$footer.show(),$header.show(),$body.removeClass("is-article-visible"),locked=!1,$body.removeClass("is-switching"),$window.scrollTop(0).triggerHandler("resize.flexbox-fix")):(locked=!0,$article.removeClass("active"),setTimeout(function(){$article.hide(),$main.hide(),$footer.show(),$header.show(),setTimeout(function(){$body.removeClass("is-article-visible"),$window.scrollTop(0).triggerHandler("resize.flexbox-fix"),setTimeout(function(){locked=!1},325)},25)},325)))},$main_articles.each(function(){var $this=$(this);$('<div class="close">Close</div>').appendTo($this).on("click",function(){location.hash=""}),$this.on("click",function(event){event.stopPropagation()})}),$body.on("click",function(event){$body.hasClass("is-article-visible")&&$main._hide(!0)}),$window.on("keyup",function(event){27===event.keyCode&&$body.hasClass("is-article-visible")&&$main._hide(!0)}),$window.on("hashchange",function(event){""==location.hash||"#"==location.hash?(event.preventDefault(),event.stopPropagation(),$main._hide()):0<$main_articles.filter(location.hash).length&&(event.preventDefault(),event.stopPropagation(),$main._show(location.hash.substr(1)))}),"scrollRestoration"in history?history.scrollRestoration="manual":(scrollPos=oldScrollPos=0,$htmlbody=$("html,body"),$window.on("scroll",function(){oldScrollPos=scrollPos,scrollPos=$htmlbody.scrollTop()}).on("hashchange",function(){$window.scrollTop(oldScrollPos)})),$main.hide(),$main_articles.hide(),""!=location.hash&&"#"!=location.hash&&$window.on("load",function(){$main._show(location.hash.substr(1),!0)})}(jQuery);